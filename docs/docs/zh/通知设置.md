---
id: notifications
title: 通知设置
---

# 通知设置

Frigate 使用 [WebPush 协议](https://web.dev/articles/push-notifications-web-push-protocol) 提供原生通知功能，该协议使用 [VAPID 规范](https://tools.ietf.org/html/draft-thomson-webpush-vapid) 通过加密向 Web 应用发送通知。

## 设置通知

要使用通知功能，必须满足以下要求：

- Frigate 必须通过安全的 `https` 连接访问（[参见授权文档](/configuration/authentication)）。
- 必须使用受支持的浏览器。目前支持 Chrome、Firefox 和 Safari。
- 要在外部使用通知功能，Frigate 必须可以从外部访问。
- 对于 iOS 设备，一些用户指出需要在 iOS 设置中启用通知开关：设置 → 应用 → Safari → 高级 → 功能。

### 配置

要配置通知，请进入 Frigate WebUI -> 设置 -> 通知，启用通知并填写字段后保存。

您也可以通过配置文件中的 `cooldown` 参数来更改通知的默认冷却时间。此参数也可以在摄像头级别进行覆盖。

如果满足以下任一条件，将阻止发送通知：

- 自上次任何摄像头发送通知以来，全局冷却时间尚未结束
- 特定摄像头的摄像头特定冷却时间尚未结束

```yaml
notifications:
  enabled: True
  email: "your-email@example.com"
  cooldown: 10 # 等待 10 秒后再从任何摄像头发送另一个通知
```

```yaml
cameras:
  doorbell:
    ...
    notifications:
      enabled: True
      cooldown: 30 # 等待 30 秒后再从门铃摄像头发送另一个通知
```

### 设备注册

启用通知后，在所有您希望接收通知的设备上按下"注册通知"按钮。这将注册后台工作程序。之后必须重启 Frigate，然后将开始发送通知。

## 支持的通知类型

目前仅支持审查警报的通知。未来将支持更多通知类型。

:::note

目前，只有 Chrome 支持在通知中显示图片。Safari 和 Firefox 在通知中只会显示标题和消息。

:::

## 减少通知延迟

不同平台处理通知的方式不同，可能需要更改一些设置以获得最佳的通知传递效果。

### Android

大多数 Android 手机都有电池优化设置。为了获得可靠的通知传递，浏览器（Chrome、Firefox）应该禁用电池优化。如果 Frigate 作为 PWA 运行，则 Frigate 应用也应该禁用电池优化。

## 技术实现细节

在前端，通知功能通过 `notifications-worker.js` 实现，这是一个 Service Worker，负责：

1. 接收推送事件
2. 显示通知
3. 处理通知点击事件

在后端，`WebPushClient` 类负责：

1. 管理 VAPID 密钥
2. 处理用户订阅
3. 发送推送通知
4. 管理冷却期和暂停状态

通知的 API 端点包括：

- `/notifications/pubkey` - 获取 VAPID 公钥
- `/notifications/register` - 注册设备订阅

这个通知系统为用户提供了一个强大而灵活的方式，可以在检测到重要事件时及时收到提醒。